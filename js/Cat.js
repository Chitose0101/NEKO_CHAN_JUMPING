class Jumper extends Entity{
    /*
    ジャンプするエンティティの親クラス
    */

    constructor(display_height, x) {
        /*
        コントラスタ
        */
        super(x);
        this.display_height = display_height
        this.set_xy(this.x, this.display_height - this.height - 1)
        //ジャンプ中か
        this.is_jumping = false;
        //ジャンプしてから何フレーム経過したか
        this.jump_timer = 0;
    }

    click_event() {
        /*
        クリック時のイベント
        */
        //ジャンプする
        this.is_jumping = true;
    }

    calculate_jump_height(jump_timer = this.jump_timer) {
        /*
        ジャンプの高さを算出
        */

        //重力加速度g、初速度v、時間t
        const g = 0.9;
        const v = 9;
        let t = jump_timer;

        const jump_height = parseInt(v*t - g*t*t/2);
        if (jump_height > 0) {
            return jump_height
        } else {
            return 0
        }
    }

    count_jump_timer() {
        /*
        jump_timerの更新
        */

        //もしジャンプ中でなければなら更新しない
        if (this.is_jumping == false) {
            return;
        }
        
        //もし次の高さが0より高ければ、増加
        if (this.calculate_jump_height(this.jump_timer + 1) > 0) {
            this.jump_timer += 1;

        //そうでなければ、0
        } else {
            this.jump_timer = 0;
            this.is_jumping = false;
        }
    }

    timing_event() {
        /*
        フレームごとの処理
        */
        super.timing_event();

        //jump_timerの更新
        this.count_jump_timer();

        //y座標の更新
        this.y = this.display_height - this.height - 1 - this.calculate_jump_height();
    }
}

class Cat extends Jumper{
    /*
    ﾈｺﾁｬﾝのクラス
    */

    constructor(display_height, x) {
        /*
        コントラスタ
        */
        super(display_height, x);
    }

    set_collider() {
        /*
        設定
        */

        //初期位置x
        this.init_x = 16;
        //アニメーションの速さ
        this.animation_speed = 5;

        //アニメーション
        this.animation = [[
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],
                [0,0,0,0,1,2,1,0,0,0,1,2,1,0,0,0],
                [0,0,0,1,2,2,2,1,1,1,2,2,1,0,0,0],
                [0,0,0,1,2,2,2,2,2,2,2,2,1,0,0,0],
                [0,0,1,2,2,2,2,2,2,2,2,2,2,1,0,0],
                [0,0,1,2,2,2,2,2,2,2,2,2,2,1,0,0],
                [0,1,1,2,2,2,1,2,2,2,1,2,2,1,0,0],
                [1,2,1,2,2,2,1,2,2,2,1,2,2,1,0,0],
                [1,2,1,1,2,2,2,2,2,2,2,2,1,0,0,0],
                [0,1,2,2,1,2,2,1,1,1,1,1,0,0,0,0],
                [0,1,2,2,2,2,2,1,0,0,0,0,0,0,0,0],
                [0,1,2,1,2,1,2,1,0,0,0,0,0,0,0,0],
                [0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
            ],[
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],
                [0,0,0,0,1,2,1,0,0,0,1,2,1,0,0,0],
                [0,0,0,1,2,2,2,1,1,1,2,2,1,0,0,0],
                [0,0,0,1,2,2,2,2,2,2,2,2,1,0,0,0],
                [0,0,1,2,2,2,2,2,2,2,2,2,2,1,0,0],
                [0,0,1,2,2,2,2,2,2,2,2,2,2,1,0,0],
                [0,1,1,2,2,2,1,2,2,2,1,2,2,1,0,0],
                [1,2,1,2,2,2,1,2,2,2,1,2,2,1,0,0],
                [1,2,1,1,2,2,2,2,2,2,2,2,1,0,0,0],
                [0,1,2,2,1,2,2,1,1,1,1,1,0,0,0,0],
                [0,1,2,2,2,2,2,1,0,0,0,0,0,0,0,0],
                [0,1,1,2,1,2,1,1,0,0,0,0,0,0,0,0],
                [0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0], 
            ]];

            this.collider = [[
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],
                [0,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0],
                [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0],
                [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
                [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
                [0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0],
                [0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0],
                [0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0],
                [0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
                [0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
                [0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            ],[
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],
                [0,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0],
                [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0],
                [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
                [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
                [0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0],
                [0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0],
                [0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0],
                [0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
                [0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
                [0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        ]];

        //コライダーの補足
        super.set_collider()
    }
}
